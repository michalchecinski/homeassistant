- id: ola_guest_mode
  alias: Ola in house - set guest mode on
  trigger:
    - platform: state
      entity_id: calendar.ola
      from: 'off'
      to: 'on'
    - platform: state
      entity_id: input_boolean.michal_home
      from: 'off'
      to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_boolean.michal_home
        state: 'on'
      - condition: state
        entity_id: calendar.ola_michal
        state: 'on'
      - condition: template
        value_template: '{{ states.calendar.ola_michal.attributes.all_day != true }}'
  action:
    - service: homeassistant.turn_on
      data:
        entity_id: input_boolean.guest_mode

- id: ola_guest_off
  alias: Come back from Ola - set guest mode off
  trigger:
    - platform: state
      entity_id: input_boolean.michal_home
      from: 'off'
      to: 'on'
  condition:
    condition: and
    conditions:
      - condition: state
        entity_id: input_boolean.michal_home
        state: 'on'
      - condition: or
        conditions:
          - condition: state
            entity_id: calendar.ola_michal
            state: 'off'
          - condition: template
            value_template: '{{ states.calendar.ola_michal.attributes.all_day == true }}'
      - condition: state
        entity_id: input_boolean.guest_mode
        state: 'on'
  action:
    - service: homeassistant.turn_off
      data:
        entity_id: input_boolean.guest_mode